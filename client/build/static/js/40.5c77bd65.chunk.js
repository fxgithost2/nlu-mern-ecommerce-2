(this["webpackJsonpmern.ecommerce.client"]=this["webpackJsonpmern.ecommerce.client"]||[]).push([[40],{3641:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return U}));var a=n(16),r=n(1),i=n(199),c=n(618),o=n(305),s=n(2772),d=n(2729),u=n(6),l=n(35),h=n(92),j=n(422),p=n(544),b=n(3),m=n(10),f=n.n(m),O=n(17),x=n(231),g=n(232),w=n(2655),v=n(2727),y=n(2720),P=n(101),C=n(401),S=n(0);function q(e){var t=e.onChangePassword,n=e.isLoading,a=Object(P.d)().t,r=g.f().shape({newPassword:g.h().min(6,a("auth.new-password-min")).max(32,a("auth.new-password-max")).required(a("auth.new-password-required")),confirmNewPassword:g.h().required(a("auth.confirm-password-required")).oneOf([g.g("newPassword"),null],a("auth.confirm-password-not-match"))}),i=Object(x.d)({initialValues:{newPassword:"",confirmNewPassword:""},validationSchema:r,onSubmit:function(){var e=Object(O.a)(f.a.mark((function e(n){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C.a(t)&&(a=n.newPassword,t(a));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),c=i.errors,o=i.touched,s=i.handleSubmit,d=i.getFieldProps;return Object(S.jsx)(x.b,{value:i,children:Object(S.jsx)(x.a,{autoComplete:"off",noValidate:!0,onSubmit:s,children:Object(S.jsxs)(w.a,{spacing:3,children:[Object(S.jsx)(v.a,Object(b.a)(Object(b.a)({},d("newPassword")),{},{fullWidth:!0,autoComplete:"on",type:"password",label:a("auth.new-password"),error:Boolean(o.newPassword&&c.newPassword),helperText:o.newPassword&&c.newPassword})),Object(S.jsx)(v.a,Object(b.a)(Object(b.a)({},d("confirmNewPassword")),{},{fullWidth:!0,autoComplete:"on",type:"password",label:a("auth.confirm-new-password"),error:Boolean(o.confirmNewPassword&&c.confirmNewPassword),helperText:o.confirmNewPassword&&c.confirmNewPassword})),Object(S.jsx)(y.a,{size:"large",type:"submit",variant:"contained",loading:n,children:a("common.save-change").toUpperCase()})]})})})}var V=n(2741),k=n(2769);function L(e){if(e.target.value.length>e.target.maxLength)return e.target.value=e.target.value.slice(e.target.maxLength-1,e.target.maxLength)}function W(e){var t=e.onVerifyOtp,n=e.onResentOtp,a=e.isLoading,c=(Object(P.d)().t,g.f().shape({code1:g.e().required("Code is required"),code2:g.e().required("Code is required"),code3:g.e().required("Code is required"),code4:g.e().required("Code is required"),code5:g.e().required("Code is required"),code6:g.e().required("Code is required")})),s=Object(x.d)({initialValues:{code1:"",code2:"",code3:"",code4:"",code5:"",code6:""},validationSchema:c,onSubmit:function(){var e=Object(O.a)(f.a.mark((function e(n){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C.a(t)&&(a=Object.values(n).join(""),t(a));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),d=s.values,u=s.errors,l=s.isValid,h=s.touched,j=s.handleSubmit,p=s.getFieldProps;Object(r.useEffect)((function(){var e=document.querySelector('input[name="verify-code-input-code1"]');e&&e.focus()}),[]);var m=function(e){var t=e.target.name.replace("verify-code-input-","");s.setFieldValue(t,e.target.value);var n=["code1","code2","code3","code4","code5","code6"],a=n.indexOf(t);if(a<5){var r=document.querySelector('input[name="verify-code-input-'.concat(n[a+1],'"]'));r&&(r.focus(),r.select())}},v=function(e){if(8===e.keyCode&&!e.target.value){e.stopPropagation();var t=["code1","code2","code3","code4","code5","code6"],n=e.target.name.replace("verify-code-input-",""),a=t.indexOf(n);if(a>0){var r=document.querySelector('input[name="verify-code-input-'.concat(t[a-1],'"]'));r&&r.focus()}}};return Object(S.jsx)(x.b,{value:s,children:Object(S.jsx)(x.a,{autoComplete:"off",noValidate:!0,onSubmit:j,children:Object(S.jsxs)(w.a,{direction:"column",spacing:3,justifyContent:"center",sx:{minHeight:"200px"},children:[Object(S.jsx)(w.a,{direction:"row",spacing:2,justifyContent:"center",children:Object.keys(d).map((function(e){return Object(S.jsx)(V.a,Object(b.a)(Object(b.a)({},p(e)),{},{type:"number",placeholder:"-",onInput:L,error:Boolean(h[e]&&u[e]),onChange:m,inputProps:{maxLength:1,sx:{p:0,textAlign:"center",width:{xs:36,sm:56},height:{xs:36,sm:56}}},onFocus:function(e){return e.target.select},onKeyDown:v,name:"verify-code-input-".concat(e)}),e)}))}),Object(S.jsx)(i.a,{display:"flex",justifyContent:"flex-end",children:Object(S.jsx)(k.a,{error:!l,style:{textAlign:"right",marginTop:0},children:(null===u||void 0===u?void 0:u.verifyResult)||!l&&"Vui l\xf2ng nh\u1eadp m\xe3 OTP g\u1ed3m 6 ch\u1eef s\u1ed1"})}),Object(S.jsxs)(i.a,{display:"flex",justifyContent:"center",children:[Object(S.jsx)(o.a,{fullWidth:!0,onClick:function(e){C.a(n)&&n()},color:"inherit",sx:{m:1},disabled:a,children:"G\u1eedi l\u1ea1i"}),Object(S.jsx)(y.a,{fullWidth:!0,size:"large",type:"submit",variant:"contained",loading:a,sx:{m:1},children:"X\xe1c nh\u1eadn"})]})]})})})}var N=n(32),B=n(36),z=n(414);function F(e){var t=e.onSendOtp,n=e.isSending,a=Object(P.d)().t,r=g.f().shape({emailOrPhone:g.h().required(a("auth.email-or-phone-required")).test("test-name",(function(e,t){var n=t.createError;return/^\d.+$/.test(e)?!!z.a.phone.test(e)||n({message:a("address.phone-invalid")}):!!z.a.email.test(e)||n({message:a("auth.email-invalid")})}))}),c=Object(x.d)({initialValues:{emailOrPhone:""},validationSchema:r,onSubmit:function(){var e=Object(O.a)(f.a.mark((function e(n){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=n.emailOrPhone,t(a);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),s=c.errors,d=c.touched,u=c.handleSubmit,l=c.getFieldProps;return Object(S.jsx)(x.b,{value:c,children:Object(S.jsx)(x.a,{autoComplete:"off",noValidate:!0,onSubmit:u,children:Object(S.jsxs)(w.a,{spacing:3,children:[Object(S.jsx)(v.a,Object(b.a)(Object(b.a)({fullWidth:!0},l("emailOrPhone")),{},{type:"text",label:a("auth.email-or-phone"),error:Boolean(d.emailOrPhone&&s.emailOrPhone),helperText:d.emailOrPhone&&s.emailOrPhone})),Object(S.jsxs)(i.a,{display:"flex",justifyContent:"center",children:[Object(S.jsx)(o.a,{fullWidth:!0,size:"large",component:N.b,to:B.a.login,sx:{mt:1},children:a("common.back").toUpperCase()}),Object(S.jsx)(y.a,{fullWidth:!0,size:"large",type:"submit",variant:"contained",loading:n,children:a("auth.send-otp").toUpperCase()})]})]})})})}var A=n(389),T=n(124),E=n(236),R=Object(u.a)(A.a)((function(e){return{display:"flex",minHeight:"100%",alignItems:"center",justifyContent:"center",padding:e.theme.spacing(12,0)}}));function U(){var e=Object(P.d)(),t=e.t,n=e.currentLang,u=Object(l.h)(),b=Object(h.b)(),m=Object(h.c)((function(e){return e.auth.otp})),f=m.emailOrPhone,O=m.isLoading,x=m.isVerifying,g=m.isSent,w=m.isVerified,v=m.isChangingPass,y=m.isChangeSuccess,C=m.error,V=Object(r.useState)(""),k=Object(a.a)(V,2),L=k[0],N=k[1];Object(r.useEffect)((function(){var e;C?N((null===C||void 0===C||null===(e=C.message)||void 0===e?void 0:e[n.value])||"L\u1ed7i"):N(null)}),[n.value,C]),Object(r.useEffect)((function(){window.recaptchaVerifier=new E.b.auth.RecaptchaVerifier("invisible-recaptcha",{size:"invisible",defaultCountry:"VN",callback:function(e){console.log("response",e)}})}),[]);var A=function(e){z.a.email.test(e)?b(Object(j.g)(e)):b(Object(j.h)(e))},U=function(){b(Object(j.e)())},H=function(e){z.a.email.test(f)?b(Object(j.a)(f,e)):b(Object(j.b)(f,e))},I=function(e){b(Object(j.f)(e))},J=function(e){b(Object(j.c)()),u(B.a.login)};return Object(S.jsxs)(R,{title:t("auth.page-title.reset-password"),children:[Object(S.jsx)(p.a,{}),Object(S.jsx)(s.a,{children:Object(S.jsxs)(i.a,{sx:{maxWidth:480,mx:"auto"},children:[y?Object(S.jsxs)(i.a,{sx:{textAlign:"center"},children:[Object(S.jsx)(T.a,{sx:{mb:5,mx:"auto",height:160}}),Object(S.jsx)(c.a,{variant:"h3",gutterBottom:!0,sx:{mb:3},children:t("auth.set-new-password-success")}),Object(S.jsx)(o.a,{fullWidth:!0,size:"large",onClick:J,variant:"contained",children:t("auth.login").toUpperCase()})]}):g?w?Object(S.jsxs)(i.a,{sx:{textAlign:"center"},children:[Object(S.jsx)(c.a,{variant:"h3",gutterBottom:!0,sx:{mb:3},children:t("auth.set-new-password")}),Object(S.jsx)(q,{onChangePassword:I,isLoading:v})]}):Object(S.jsxs)(i.a,{sx:{textAlign:"center"},children:[Object(S.jsx)(T.i,{sx:{mb:5,mx:"auto",height:160}}),Object(S.jsx)(c.a,{variant:"h3",gutterBottom:!0,children:t("auth.send-otp-success")}),Object(S.jsx)(c.a,{children:t("auth.send-otp-desc")}),Object(S.jsx)(W,{onResentOtp:U,onVerifyOtp:H,isLoading:x})]}):Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(c.a,{variant:"h3",paragraph:!0,children:t("auth.reset-password")}),Object(S.jsx)(c.a,{sx:{color:"text.secondary",mb:5},children:t("auth.reset-password-desc")}),Object(S.jsx)(F,{onSendOtp:A,isSending:O})]}),L&&Object(S.jsx)(d.a,{severity:"error",sx:{mt:3},children:L})]})})]})}}}]);
//# sourceMappingURL=40.5c77bd65.chunk.js.map